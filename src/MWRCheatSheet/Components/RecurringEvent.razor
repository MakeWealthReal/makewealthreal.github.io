@inherits Components.ComponentBase
@using Components
@using MWRCheatSheet.Components
@using System.Runtime.CompilerServices
@inject NavigationManager NavigationManager
@inject HttpClient Http

<MudCard>
    <MudCardHeader>
        <CardHeaderContent>
            <MudText Typo="Typo.body1">@Header</MudText>
        </CardHeaderContent>
    </MudCardHeader>
    <MudCardMedia Image="@ImageUri"/>
    <MudCardContent>
        <MudStack>
            <MudText Typo="Typo.body2" Align="Align.Center">@(Recurrence.Day)s @@ @GetNextEvent(this.Recurrence.Day, this.Recurrence.Time, this.Recurrence.TimeZone).ToOffset(TimeZoneInfo.Local.BaseUtcOffset).ToString(" h:mm tt") @TimeZoneInfo.Local.StandardName</MudText>
        </MudStack>
    </MudCardContent>
    <MudCardActions>
        <MudStack Style="width:100%;">
            <MudStack Row="true" Style="width:100%;">
                <MudSpacer/>
                <ExternalLink Href="@Url" Text="Join Now!"/>
                <MudSpacer/>
            </MudStack>
            <MudStack Row="true" Style="width:100%;">
                <MudSpacer/>
                <CopyTextMinimal Tooltip="Invitation copied!"
                                 TextToCopy="@Text"
                                 ImageUrl="@ImageUri"/>
                <MudSpacer/>
            </MudStack>
        </MudStack>
    </MudCardActions>
</MudCard>

@code {
    [Parameter]
    public string Header { get; set; } = "72-Hour Money Challenge!";

    [Parameter]
    public string ImageUri { get; set; }

    [Parameter]
    public string Text { get; set; }

    [Parameter]
    public (DayOfWeek Day, TimeOnly Time, TimeZoneInfo TimeZone) Recurrence { get; set; }

    [Parameter]
    public string Url { get; set; }
}
